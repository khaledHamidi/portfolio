{{ $page := .wcPage }}
{{ $block := .wcBlock }}
{{ $view := $block.design.view | default "card" }}

{{ $items_offset := $block.content.offset | default 0 }}
{{ $items_count := $block.content.count | default 65535 }}

{{ $query := site.RegularPages }}
{{ if $block.content.filters.folders }}
  {{ $folders := $block.content.filters.folders }}
  {{ $query = where $query "Section" "in" $folders }}
{{ end }}

{{ $query = first $items_count (after $items_offset $query) }}

{{ if $block.content.title }}
  <div class="text-center mb-6">
    <h2 class="text-3xl font-bold text-gray-900 dark:text-white">
      {{ $block.content.title | emojify | $page.RenderString }}
    </h2>
    {{ with $block.content.summary }}
      <p class="mt-2 text-gray-600 dark:text-gray-300">{{ . | $page.RenderString }}</p>
    {{ end }}
  </div>
{{ end }}

<!-- ✅ عرض أفقي باستخدام flex -->
<div class="flex flex-wrap justify-center gap-6 px-4">

  {{ range $index, $item := $query }}
    <div class="w-full sm:w-1/2 md:w-1/3 lg:w-1/4">
      {{ partial "functions/render_view" (dict "page" $block "item" $item "view" $view "index" $index "config" (dict "fill_image" true)) }}
    </div>
  {{ end }}

</div>
